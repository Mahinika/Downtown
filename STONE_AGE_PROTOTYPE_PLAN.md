# Stone Age Prototype Implementation Plan

## Overview
Minimal viable prototype for Stone Age city management game. Focus on core gameplay loop: place buildings, manage resources, grow population.

## Prototype Scope

### ✅ Included Systems

#### 1. Grid/TileMap System
- **Purpose**: Foundation for building placement
- **Implementation**: Godot TileMap with grid overlay
- **Features**:
  - Visual grid (toggle on/off for debugging)
  - Grid coordinates (X, Y tile positions)
  - Building placement validation (check if tile is available)
  - Grid size: Start with 20x20 tiles (expandable)

#### 2. Basic Resource System
- **Resources**: 4 resources total
  - **Food**: Generated by Fire Pit, consumed by population
  - **Wood**: Starting resource, consumed by buildings
  - **Stone**: Starting resource, consumed by buildings
  - **Population**: Generated by Hut, abstract number (not individual villagers)
- **Implementation**: ResourceManager (Autoload singleton)
- **Features**:
  - Resource storage (initial capacity, expandable with Storage Pit)
  - Resource generation/consumption per building
  - Resource display in UI
  - Starting resources: 100 Food, 50 Wood, 50 Stone, 10 Population

#### 3. Simple Building System
- **Buildings**: 4-5 buildings total
  - **Hut** (Residential): Generates Population, consumes Food
    - Cost: 20 Wood, 10 Stone
    - Effect: +2 Population per minute, -1 Food per minute
  - **Fire Pit** (Production): Generates Food
    - Cost: 10 Wood, 5 Stone
    - Effect: +3 Food per minute
  - **Storage Pit** (Storage): Increases storage capacity
    - Cost: 15 Wood, 15 Stone
    - Effect: +50 storage capacity for all resources
  - **Tool Workshop** (Production): Optional - generates tools/research points
    - Cost: 30 Wood, 20 Stone
    - Effect: TBD (future research system)
- **Implementation**: BuildingManager (Autoload singleton)
- **Features**:
  - Building placement on grid
  - Building validation (check resources, check tile availability)
  - Building data from JSON (data-driven)
  - Building visual representation (simple colored rectangles for prototype)
  - Building effects (resource generation/consumption)

#### 4. Resource Generation/Consumption
- **Implementation**: Per-building tick system
- **Mechanics**:
  - Each building generates/consumes resources every second (or every N seconds)
  - ResourceManager processes all building effects
  - Resources update in real-time
  - Negative resources allowed? (TBD - can lead to starvation or prevent)

#### 5. Basic UI
- **Resource Display**: Top HUD showing all 4 resources with icons
- **Building Selection Panel**: Bottom toolbar (mobile-friendly) with building buttons
- **Grid Overlay Toggle**: Debug feature (F1 key or button)
- **Building Info**: Show building cost and effects when selected
- **Touch Controls**: Tap to place building, tap building to see info

#### 6. Touch Controls (Android Mobile)
- **Building Placement**: Tap grid tile to place selected building
- **Camera**: Pinch-to-zoom, drag to pan (future - start with fixed camera)
- **UI Interactions**: Tap buttons, swipe panels (if needed)
- **Minimum Touch Targets**: 44x44 pixels for all interactive elements

### ❌ Deferred Systems (Add Later)

- Research/Technology System
- Individual Villager AI (using abstract population number)
- Age Progression (Stone Age only for prototype)
- Complex Building Transformation Chains
- Events/Disasters
- Advanced UI (menus, stats panels, tutorials, save/load)
- Pathfinding (not needed with abstract population)
- Building Upgrades
- Multiple Building Tiers

## Implementation Order

### Phase 1: Foundation (Week 1)
1. **Godot Project Setup**
   - Create project structure
   - Set up autoloads (DataManager, ResourceManager, BuildingManager)
   - Create main scene

2. **Grid System**
   - TileMap setup
   - Grid coordinate system
   - Visual grid overlay (debug)

3. **Data Manager**
   - JSON loading system
   - Create `data/buildings.json` with 4 buildings
   - Create `data/resources.json` with 4 resources

### Phase 2: Core Systems (Week 1-2)
4. **Resource Manager**
   - Resource storage system
   - Resource tracking (Food, Wood, Stone, Population)
   - Resource display in UI

5. **Building Manager**
   - Building data loading from JSON
   - Building placement validation
   - Building storage (track placed buildings)
   - Building effects (resource generation/consumption)

6. **Resource Generation/Consumption**
   - Tick system for building effects
   - Per-building resource generation
   - Per-building resource consumption
   - Resource update loop

### Phase 3: UI & Interaction (Week 2)
7. **Basic UI**
   - Resource display (top HUD)
   - Building selection panel (bottom toolbar)
   - Building info display
   - Grid overlay toggle

8. **Building Placement**
   - Tap-to-place mechanics
   - Building validation feedback
   - Resource cost deduction
   - Building visual representation

9. **Touch Controls**
   - Touch input handling
   - Building placement via tap
   - UI button interactions
   - Touch target sizing (44x44px minimum)

### Phase 4: Polish & Testing (Week 2-3)
10. **Gameplay Balance**
    - Tune resource generation/consumption rates
    - Tune building costs
    - Test core loop (place buildings → manage resources → grow)

11. **Mobile Testing**
    - Test on Android device
    - Performance optimization
    - Touch control refinement
    - UI scaling across screen sizes

12. **Bug Fixes & Polish**
    - Fix any gameplay issues
    - Improve visual feedback
    - Add basic animations/effects
    - Prepare for next phase

## Data Structure Examples

### `data/resources.json`
```json
{
  "resources": {
    "food": {
      "id": "food",
      "name": "Food",
      "icon": "res://assets/icons/food.png",
      "starting_amount": 100,
      "max_storage": 200
    },
    "wood": {
      "id": "wood",
      "name": "Wood",
      "icon": "res://assets/icons/wood.png",
      "starting_amount": 50,
      "max_storage": 200
    },
    "stone": {
      "id": "stone",
      "name": "Stone",
      "icon": "res://assets/icons/stone.png",
      "starting_amount": 50,
      "max_storage": 200
    },
    "population": {
      "id": "population",
      "name": "Population",
      "icon": "res://assets/icons/population.png",
      "starting_amount": 10,
      "max_storage": 100
    }
  }
}
```

### `data/buildings.json`
```json
{
  "buildings": {
    "hut": {
      "id": "hut",
      "name": "Hut",
      "category": "residential",
      "cost": {
        "wood": 20,
        "stone": 10
      },
      "size": [1, 1],
      "effects": {
        "generates": {
          "population": 2
        },
        "consumes": {
          "food": 1
        }
      },
      "generation_rate": 60,
      "icon": "res://assets/icons/hut.png"
    },
    "fire_pit": {
      "id": "fire_pit",
      "name": "Fire Pit",
      "category": "production",
      "cost": {
        "wood": 10,
        "stone": 5
      },
      "size": [1, 1],
      "effects": {
        "generates": {
          "food": 3
        }
      },
      "generation_rate": 60,
      "icon": "res://assets/icons/fire_pit.png"
    },
    "storage_pit": {
      "id": "storage_pit",
      "name": "Storage Pit",
      "category": "storage",
      "cost": {
        "wood": 15,
        "stone": 15
      },
      "size": [1, 1],
      "effects": {
        "storage_bonus": 50
      },
      "icon": "res://assets/icons/storage_pit.png"
    }
  }
}
```

## Success Criteria

### Minimum Viable Prototype
- ✅ Player can place buildings on grid via touch
- ✅ Buildings generate/consume resources over time
- ✅ Resources are displayed and update in real-time
- ✅ Player can see building costs and effects
- ✅ Core loop works: Place buildings → Manage resources → Grow population
- ✅ Runs at 60 FPS on mid-range Android device
- ✅ Touch controls feel responsive and intuitive

### Stretch Goals (If Time Permits)
- Building visual improvements (sprites instead of colored rectangles)
- Basic animations (building construction, resource generation)
- Sound effects (building placement, resource updates)
- Tutorial/onboarding (basic hints)

## Next Steps After Prototype

1. **Research System**: Add technology/research tree
2. **Individual Villagers**: Convert abstract population to individual AI villagers
3. **Age Progression**: Add Bronze Age with new buildings/resources
4. **Advanced Mechanics**: Building upgrades, transformation chains, events
5. **Content Expansion**: More buildings, resources, gameplay depth

## Notes

- **Keep it simple**: Focus on core loop, not features
- **Data-driven**: All building/resource data in JSON for easy balancing
- **Extensible**: Design systems to support future features (research, individual villagers, age progression)
- **Mobile-first**: Touch controls, responsive UI, performance optimization
- **Iterate quickly**: Get playable version fast, then refine based on playtesting
